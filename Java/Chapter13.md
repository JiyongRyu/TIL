# 13.  스코프

### 1. 스코프란?

- **모든 식별자(변수 이름, 함수 이름, 클래스 이름 등)는 자신이 선언된 위치에 의해 다른 코드가 식별자 자신을 참조할 수 있는 유효 범위가 결정된다. 이를 스코프(Scope, 유효범위)라 한다. 즉, 스코프는 식별자가 유효한 범위를 말한다.**

- 자바스크립트 엔진이 식별자를 검색할 때 사용하는 규칙

- 식별자는 어떤 값을 구별할 수 있어야 하므로 유일해야 한다. 식별자인 변수 이름은 중복될 수 없다. 즉, 하나의 값은 유일한 식별자에 연결되어야 한다.

```
function foo() {
  var x = 1;
  // var 키워드로 선언된 변수는 같은 스코프 내에서 중복 선언을 허용한다.
  // 아래 변수 선언문은 자바스크립트 엔진에 의해 var 키워드가 없는 것처럼 동작한다.
  var x = 2;
  console.log(x); // 2
}
foo();

function bar() {
  let x = 1;
  // let이나 const 키워드로 선언된 변수는 같은 스코프 내에서 중복 선언을 허용하지 않는다.
  let x = 2; // SyntaxError: Identifier 'x' has already been declared
}
bar();
```

### 2. 스코프의 종류

| 구분 | 설명                  | 스코프      | 변수      |
| :--: | :-------------------- | :---------- | :-------- |
| 전역 | 코드의 가장 바깥 영역 | 전역 스코프 | 전역 변수 |
| 지역 | 함수 몸체 내부        | 지역 스코프 | 지역 변수 |

### 2.1 전역과 전역스코프

![13-2](https://poiemaweb.com/assets/fs-images/13-2.png)

- 전역 변수는 어디서든지 참조할 수 있다.

### 2.2 지역과 지역 스코프

- 지역이란 함수 몸체 내부를 말한다
- 지역 변수는 자신의 지역 스코프와 하위 지역 스코프에서 유효하다

### 3. 스코프 체인

- 스코프는 함수의 중첩에 의해 계층적 구조는 갖는다
- 스코프가 계층적으로 연결된 것을 스코프 체인이라 부른다.
- **변수를 참조할 때, 자바스크립트 엔진은 스코프 체인을 통해 변수를 참조하는 코드의 스코프에서 시작하여 상위 스코프 방향으로 이동하며 선언된 변수를 검색한다**

### 3.1 스코프 체인에 의한 변수 검색

- 상위 스코프에서 유효한 변수는 하위 스코프에서 자유롭게 참조할 수 있지만 하위 스코프에서 유요한 변수를 상위 스코프에서 참조할 수 없다.

### 4. 함수 레벨 스코프

- 함수에 의해서만 지역 스코프가 생성된다.
- C나 Java 등 대부분의 프로그래밍 언어는 함수 몸체 만이 아니라 모든 코드 블록(if, for, while, try/catch 등)이 지역 스코프를 만든다. 이러한 특성을 **블록 레벨 스코프(Block level scope)**라 한다. 하지만 **var 키워드로 선언된 변수는 오로지 함수의 코드 블록 만을 지역 스코프로 인정한다.** 이러한 특성을 **함수 레벨 스코프(Function level scope)**라 한다.

### 5. 렉시컬 스코프

- 자바스크립트는 렉시컬 스코프를 따르므로 함수를 어디서 호출했는지가 아니라 함수를 어디서 정의했는지에 따라 상위 스코프를 결정한다
- 동적 스코프 : **함수를 어디서 호출**했는지에 따라 함수의 상위 스코프를 결정
- 렉시컬 스코프 (정적 스코프) : **함수를 어디서 정의**했는지에 따라 함수의 상위 스코프를 결정

